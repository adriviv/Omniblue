var background=(function(){"use strict";function l(e){return e==null||typeof e=="function"?{main:e}:e}const i=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome,d={HTTP_REQUEST:"HTTP_REQUEST"};async function f(e){const s=new AbortController,n=setTimeout(()=>s.abort(),e.timeout??1e4);try{const t=await fetch(e.url,{method:e.method,headers:{"Content-Type":"application/json",...e.headers},body:e.body?JSON.stringify(e.body):void 0,signal:s.signal});clearTimeout(n);let r;const b=t.headers.get("content-type"),a=await t.text();if(b?.includes("application/json")&&a.length>0)try{r=JSON.parse(a)}catch{r=a}else r=a||null;const u={};return t.headers.forEach((m,p)=>{u[p]=m}),t.ok?{success:!0,status:t.status,statusText:t.statusText,data:r,headers:u}:{success:!1,error:`HTTP ${t.status}: ${t.statusText}`,status:t.status,statusText:t.statusText}}catch(t){clearTimeout(n);let r=t instanceof Error?t.message:"Unknown error";return t instanceof TypeError&&r.includes("fetch")?r="Network error - backend server may not be running":t instanceof DOMException&&t.name==="AbortError"&&(r="Request timeout - backend server may not be responding"),{success:!1,error:r}}}function g(){i.runtime.onMessage.addListener((e,s,n)=>e.type===d.HTTP_REQUEST?(f(e.request).then(n).catch(t=>{n({success:!1,error:t instanceof Error?t.message:"Unknown error"})}),!0):(console.warn("[Background] Unknown message type:",e.type),!1))}const T=l(()=>{console.log("Hello background!",{id:i.runtime.id}),g()});function w(){}function o(e,...s){}const h={debug:(...e)=>o(console.debug,...e),log:(...e)=>o(console.log,...e),warn:(...e)=>o(console.warn,...e),error:(...e)=>o(console.error,...e)};let c;try{c=T.main(),c instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw h.error("The background crashed on startup!"),e}return c})();
